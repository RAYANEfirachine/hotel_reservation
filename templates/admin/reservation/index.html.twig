{% extends 'base.html.twig' %}

{% block title %}Reservations Management{% endblock %}

{% block stylesheets %}
<style>
    :root {
        --primary-gold: #c5a059;
        --deep-black: #1a1a1a;
        --soft-gray: #f8f9fa;
        --border-color: #eee;
    }

    .res-dashboard { padding: 40px 20px; max-width: 1200px; margin: 0 auto; }
    .res-header { text-align: center; margin-bottom: 50px; }
    .res-header h1 { font-family: 'Playfair Display', serif; font-size: 2.5rem; color: var(--deep-black); margin-bottom: 10px; }

    .res-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 30px; }

    .res-card {
        background: white;
        border-radius: 20px;
        overflow: hidden;
        border: 1px solid var(--border-color);
        box-shadow: 0 10px 30px rgba(0,0,0,0.05);
        transition: transform 0.3s ease;
        position: relative;
    }

    .res-card:hover { transform: translateY(-10px); }

    /* قسم الصورة */
    .res-image-wrapper { height: 200px; width: 100%; position: relative; overflow: hidden; }
    .res-image-wrapper img { width: 100%; height: 100%; object-fit: cover; }

    .status-tag {
        position: absolute;
        top: 15px;
        right: 15px;
        padding: 6px 14px;
        border-radius: 50px;
        font-size: 0.75rem;
        font-weight: 700;
        text-transform: uppercase;
        z-index: 10;
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }

    /* ألوان الحالة */
    .status-pending { background: #fff8e1; color: #f57c00; }
    .status-completed { background: #e8f5e9; color: #2e7d32; }
    .status-cancelled { background: #ffebee; color: #c62828; }

    .res-body { padding: 25px; }
    .guest-name { display: block; font-size: 1.2rem; font-weight: 700; color: var(--deep-black); margin-bottom: 5px; }
    .room-type { display: block; color: var(--primary-gold); font-size: 0.9rem; font-weight: 600; margin-bottom: 20px; }

    .res-info-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 0.85rem; border-bottom: 1px dashed #eee; padding-bottom: 8px; }
    .res-info-row label { color: #999; text-transform: uppercase; letter-spacing: 1px; }
    .res-info-row span { font-weight: 600; color: var(--deep-black); }

    .res-footer { display: flex; justify-content: space-between; align-items: center; margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--border-color); }
    .res-price { font-size: 1.4rem; font-weight: 700; color: var(--deep-black); }

    .res-actions { display: flex; gap: 10px; }
    .btn-manage {
        text-decoration: none;
        padding: 8px 16px;
        border-radius: 8px;
        font-size: 0.8rem;
        font-weight: 600;
        transition: 0.3s;
        background: var(--deep-black);
        color: white;
    }
    .btn-manage:hover { background: var(--primary-gold); }
</style>
{% endblock %}

{% block body %}
<div class="res-dashboard">
    <div class="res-header">
        <h1>Reservations Management</h1>
        <p class="text-muted">High-end overview of your current guest stays.</p>
    </div>

    <div class="res-grid">
        {% for reservation in reservations %}
            <div class="res-card">
                {# حالة الحجز تظهر فوق الصورة #}
                <span class="status-tag status-{{ reservation.status|lower }}">
                    {{ reservation.status }}
                </span>

                {# قسم الصورة #}
                <div class="res-image-wrapper">
                    {% if reservation.room.image %}
                        <img src="{{ asset('uploads/rooms/' ~ reservation.room.image) }}" alt="Room {{ reservation.room.numRoom }}">
                    {% else %}
                        <img src="https://images.unsplash.com/photo-1566073771259-6a8506099945?auto=format&fit=crop&w=800&q=80" alt="Default Luxury Room">
                    {% endif %}
                </div>

                <div class="res-body">
                    <span class="guest-name">{{ reservation.user.firstName }} {{ reservation.user.lastName }}</span>
                    <span class="room-type">Room {{ reservation.room.numRoom }} — {{ reservation.room.roomType.type }}</span>

                    <div class="res-info-row">
                        <label>Check In</label>
                        <span>{{ reservation.checkInDate|date('d M Y') }}</span>
                    </div>

                    <div class="res-info-row">
                        <label>Check Out</label>
                        <span>{{ reservation.checkOutDate|date('d M Y') }}</span>
                    </div>

                    <div class="res-info-row">
                        <label>Reference</label>
                        <span>#RES-{{ reservation.id }}</span>
                    </div>

                    <div class="res-footer">
                        <span class="res-price">${{ reservation.totalPrice }}</span>
                        <div class="res-actions">
                            <a href="#" class="btn-manage">View</a>
                            <a href="#" class="btn-manage" style="background: transparent; color: var(--deep-black); border: 1px solid var(--border-color);">Edit</a>
                        </div>
                    </div>
                </div>
            </div>
        {% else %}
            <div style="grid-column: 1 / -1; text-align: center; padding: 100px; background: white; border-radius: 20px;">
                <p>No reservations found at the moment.</p>
            </div>
        {% endfor %}
    </div>
</div>
{% endblock %}
